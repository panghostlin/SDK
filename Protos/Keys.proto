syntax = "proto3";

service KeysService {
	rpc CreateKeys(CreateKeysRequest) returns (CreateKeysResponse) {}
	rpc CheckPassword(CheckPasswordRequest) returns (CheckPasswordResponse) {}
	rpc EncryptPicture(stream EncryptPictureRequest) returns (stream EncryptPictureResponse) {}
	rpc DecryptPicture(stream DecryptPictureRequest) returns (stream DecryptPictureResponse) {}
}

message CreateKeysRequest {
	string password = 1;
	string memberID = 2;
}
message CreateKeysResponse {
	bool success = 1;
	string hashKey = 2;
}


message CheckPasswordRequest {
	string password = 1;
	string memberID = 2;
}
message CheckPasswordResponse {
	bool success = 1;
	string hashKey = 2;
}


message EncryptPictureRequest {
	bytes chunk = 1;		//	The data to encrypt
	string memberID = 2;	//	The owner of the data/the encryptor
}
message EncryptPictureResponse {
	bytes chunk = 1;		//	The data encrypted
	bool success = 2;		//	Was the encryption a success ?
	string key = 3;			//	Which is the key to decrypt chunk ?
}


message DecryptPictureRequest {
	bytes chunk = 1;		//	The data to encrypt
	string memberID = 2;	//	The owner of the data/the encryptor
	string key = 3;			//	The key to decrypt
	string hashKey = 4;		//	The user decrypt key
}
message DecryptPictureResponse {
	bool success = 1;
	string key = 2;
	// bytes encrypted = 3;
	bytes chunk = 3;
}